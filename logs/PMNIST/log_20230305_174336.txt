====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=10, gpm_thro1=0.94, gpm_thro2=0.99, gpm_thro3=0.99, lr=0.01, lr_factor=2, lr_min=1e-05, lr_patience=6, mixup_alpha=20, mixup_weight=0.1, momentum=0.9, n_epochs=5, n_hidden=100, n_outputs=10, n_tasks=10, pc_valid=0.1, savename='./logs/PMNIST/DFGP/', seed=1)
====================================================================================================
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  0 (pmnist-0)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.01
----------------------------------------
Model parameters ---
----------------------------------------
Epoch   1 | Train: loss=0.182, acc= 94.7% | time=9903.6ms |
 Valid: loss=0.174, acc= 95.2% |

Epoch   2 | Train: loss=0.116, acc= 96.9% | time=7913.7ms |
 Valid: loss=0.121, acc= 96.8% |

Epoch   3 | Train: loss=0.087, acc= 97.6% | time=7837.3ms |
 Valid: loss=0.098, acc= 97.2% |

Epoch   4 | Train: loss=0.068, acc= 98.2% | time=8242.8ms |
 Valid: loss=0.084, acc= 97.5% |

Epoch   5 | Train: loss=0.058, acc= 98.4% | time=8252.6ms |
 Valid: loss=0.079, acc= 97.8% |

----------------------------------------
Test: loss=0.076 , acc= 97.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 72/784
Layer 2 : 66/100
Layer 3 : 51/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  1 (pmnist-1)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.140, acc= 96.0% | time=8406.7ms |
 Valid: loss=0.143, acc= 95.9% |

Epoch   2 | Train: loss=0.101, acc= 97.2% | time=9362.7ms |
 Valid: loss=0.111, acc= 96.7% |

Epoch   3 | Train: loss=0.082, acc= 97.8% | time=8487.9ms |
 Valid: loss=0.098, acc= 97.1% |

Epoch   4 | Train: loss=0.070, acc= 98.1% | time=8172.1ms |
 Valid: loss=0.090, acc= 97.5% |

Epoch   5 | Train: loss=0.062, acc= 98.3% | time=8537.4ms |
 Valid: loss=0.083, acc= 97.6% |

Test: loss=0.081 , acc= 97.5%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 135/784
Layer 2 : 89/100
Layer 3 : 71/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.7%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  2 (pmnist-2)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.155, acc= 95.6% | time=8148.1ms |
 Valid: loss=0.155, acc= 95.7% |

Epoch   2 | Train: loss=0.118, acc= 96.7% | time=8100.9ms |
 Valid: loss=0.126, acc= 96.3% |

Epoch   3 | Train: loss=0.096, acc= 97.4% | time=8152.7ms |
 Valid: loss=0.109, acc= 96.9% |

Epoch   4 | Train: loss=0.084, acc= 97.8% | time=8151.1ms |
 Valid: loss=0.101, acc= 97.0% |

Epoch   5 | Train: loss=0.073, acc= 98.0% | time=8081.6ms |
 Valid: loss=0.094, acc= 97.2% |

Test: loss=0.089 , acc= 97.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 197/784
Layer 2 : 96/100
Layer 3 : 82/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.7%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.5%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  3 (pmnist-3)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.160, acc= 95.6% | time=8112.4ms |
 Valid: loss=0.161, acc= 95.8% |

Epoch   2 | Train: loss=0.116, acc= 96.8% | time=8179.9ms |
 Valid: loss=0.126, acc= 96.2% |

Epoch   3 | Train: loss=0.097, acc= 97.3% | time=8116.8ms |
 Valid: loss=0.111, acc= 96.9% |

Epoch   4 | Train: loss=0.086, acc= 97.7% | time=8104.7ms |
 Valid: loss=0.106, acc= 96.8% |

Epoch   5 | Train: loss=0.076, acc= 98.0% | time=8171.8ms |
 Valid: loss=0.097, acc= 97.3% |

Test: loss=0.093 , acc= 97.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 253/784
Layer 2 : 98/100
Layer 3 : 85/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.7%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.5%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.2%  97.2%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  4 (pmnist-4)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.197, acc= 94.5% | time=8175.8ms |
 Valid: loss=0.189, acc= 94.8% |

Epoch   2 | Train: loss=0.149, acc= 96.0% | time=8251.8ms |
 Valid: loss=0.149, acc= 95.8% |

Epoch   3 | Train: loss=0.124, acc= 96.7% | time=8130.8ms |
 Valid: loss=0.129, acc= 96.3% |

Epoch   4 | Train: loss=0.108, acc= 97.1% | time=8126.4ms |
 Valid: loss=0.118, acc= 96.8% |

Epoch   5 | Train: loss=0.097, acc= 97.3% | time=8120.3ms |
 Valid: loss=0.110, acc= 96.8% |

Test: loss=0.111 , acc= 96.9%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 304/784
Layer 2 : 99/100
Layer 3 : 88/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.7%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.5%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.2%  97.2%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.7%  96.9%  96.9%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  5 (pmnist-5)
****************************************************************************************************
----------------------------------------
Task ID :5 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.221, acc= 93.6% | time=8141.8ms |
 Valid: loss=0.211, acc= 93.9% |

Epoch   2 | Train: loss=0.164, acc= 95.4% | time=8121.6ms |
 Valid: loss=0.165, acc= 95.4% |

Epoch   3 | Train: loss=0.138, acc= 96.2% | time=8115.6ms |
 Valid: loss=0.146, acc= 96.0% |

Epoch   4 | Train: loss=0.122, acc= 96.7% | time=8091.3ms |
 Valid: loss=0.134, acc= 96.3% |

Epoch   5 | Train: loss=0.109, acc= 97.0% | time=8067.0ms |
 Valid: loss=0.126, acc= 96.5% |

Test: loss=0.124 , acc= 96.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 351/784
Layer 2 : 99/100
Layer 3 : 89/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.7%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.5%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.2%  97.2%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.7%  96.9%  96.9%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.4%  96.3%  96.6%  96.4%  96.4%  96.3%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  6 (pmnist-6)
****************************************************************************************************
----------------------------------------
Task ID :6 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.218, acc= 93.6% | time=8104.1ms |
 Valid: loss=0.220, acc= 93.8% |

Epoch   2 | Train: loss=0.165, acc= 95.3% | time=8124.4ms |
 Valid: loss=0.174, acc= 95.2% |

Epoch   3 | Train: loss=0.138, acc= 96.1% | time=8175.5ms |
 Valid: loss=0.151, acc= 95.7% |

Epoch   4 | Train: loss=0.121, acc= 96.6% | time=8181.8ms |
 Valid: loss=0.138, acc= 96.0% |

Epoch   5 | Train: loss=0.111, acc= 96.9% | time=8087.1ms |
 Valid: loss=0.131, acc= 96.2% |

Test: loss=0.128 , acc= 96.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 394/784
Layer 2 : 100/100
Layer 3 : 90/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.7%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.5%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.2%  97.2%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.7%  96.9%  96.9%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.4%  96.3%  96.6%  96.4%  96.4%  96.3%   0.0%   0.0%   0.0%   0.0% 
 96.0%  96.2%  96.3%  95.8%  96.1%  95.9%  96.3%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  7 (pmnist-7)
****************************************************************************************************
----------------------------------------
Task ID :7 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.251, acc= 92.7% | time=8163.1ms |
 Valid: loss=0.244, acc= 93.1% |

Epoch   2 | Train: loss=0.185, acc= 94.7% | time=8127.7ms |
 Valid: loss=0.185, acc= 94.7% |

Epoch   3 | Train: loss=0.154, acc= 95.7% | time=8166.1ms |
 Valid: loss=0.159, acc= 95.5% |

Epoch   4 | Train: loss=0.136, acc= 96.2% | time=8097.2ms |
 Valid: loss=0.145, acc= 95.8% |

Epoch   5 | Train: loss=0.123, acc= 96.6% | time=8109.7ms |
 Valid: loss=0.136, acc= 96.2% |

Test: loss=0.139 , acc= 95.9%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
Skip Updating GPM for layer: 3
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 433/784
Layer 2 : 100/100
Layer 3 : 90/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.7%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.5%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.2%  97.2%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.7%  96.9%  96.9%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.4%  96.3%  96.6%  96.4%  96.4%  96.3%   0.0%   0.0%   0.0%   0.0% 
 96.0%  96.2%  96.3%  95.8%  96.1%  95.9%  96.3%   0.0%   0.0%   0.0% 
 95.5%  96.0%  95.9%  95.6%  95.9%  95.6%  95.7%  95.9%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  8 (pmnist-8)
****************************************************************************************************
----------------------------------------
Task ID :8 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.276, acc= 91.9% | time=8229.0ms |
 Valid: loss=0.266, acc= 92.3% |

Epoch   2 | Train: loss=0.209, acc= 94.0% | time=8303.9ms |
 Valid: loss=0.210, acc= 93.9% |

Epoch   3 | Train: loss=0.177, acc= 95.0% | time=8363.5ms |
 Valid: loss=0.181, acc= 94.7% |

Epoch   4 | Train: loss=0.157, acc= 95.6% | time=8033.1ms |
 Valid: loss=0.166, acc= 95.2% |

Epoch   5 | Train: loss=0.142, acc= 96.0% | time=8115.3ms |
 Valid: loss=0.153, acc= 95.7% |

Test: loss=0.154 , acc= 95.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 467/784
Layer 2 : 100/100
Layer 3 : 92/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.7%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.5%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.2%  97.2%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.7%  96.9%  96.9%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.4%  96.3%  96.6%  96.4%  96.4%  96.3%   0.0%   0.0%   0.0%   0.0% 
 96.0%  96.2%  96.3%  95.8%  96.1%  95.9%  96.3%   0.0%   0.0%   0.0% 
 95.5%  96.0%  95.9%  95.6%  95.9%  95.6%  95.7%  95.9%   0.0%   0.0% 
 95.2%  95.2%  95.4%  95.2%  95.3%  95.2%  95.3%  95.3%  95.3%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  9 (pmnist-9)
****************************************************************************************************
----------------------------------------
Task ID :9 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.296, acc= 91.1% | time=8087.0ms |
 Valid: loss=0.284, acc= 91.3% |

Epoch   2 | Train: loss=0.220, acc= 93.6% | time=8067.4ms |
 Valid: loss=0.219, acc= 93.4% |

Epoch   3 | Train: loss=0.186, acc= 94.7% | time=8059.0ms |
 Valid: loss=0.190, acc= 94.4% |

Epoch   4 | Train: loss=0.163, acc= 95.3% | time=8168.4ms |
 Valid: loss=0.171, acc= 95.1% |

Epoch   5 | Train: loss=0.150, acc= 95.7% | time=8020.4ms |
 Valid: loss=0.161, acc= 95.4% |

Test: loss=0.166 , acc= 95.0%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
Skip Updating GPM for layer: 3
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 498/784
Layer 2 : 100/100
Layer 3 : 92/100
----------------------------------------
Accuracies =
 97.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.7%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.5%  97.3%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.2%  97.2%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.7%  96.9%  96.9%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.4%  96.3%  96.6%  96.4%  96.4%  96.3%   0.0%   0.0%   0.0%   0.0% 
 96.0%  96.2%  96.3%  95.8%  96.1%  95.9%  96.3%   0.0%   0.0%   0.0% 
 95.5%  96.0%  95.9%  95.6%  95.9%  95.6%  95.7%  95.9%   0.0%   0.0% 
 95.2%  95.2%  95.4%  95.2%  95.3%  95.2%  95.3%  95.3%  95.3%   0.0% 
 94.7%  94.5%  94.7%  94.6%  94.8%  94.9%  94.7%  94.7%  94.6%  95.0% 
--------------------------------------------------
Task Order : [0 1 2 3 4 5 6 7 8 9]
Final Avg Accuracy: 94.72%
Backward transfer: -2.02%
[Elapsed time = 444120.4 ms]
--------------------------------------------------
====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=10, gpm_thro1=0.94, gpm_thro2=0.99, gpm_thro3=0.99, lr=0.01, lr_factor=2, lr_min=1e-05, lr_patience=6, mixup_alpha=20, mixup_weight=0.1, momentum=0.9, n_epochs=5, n_hidden=100, n_outputs=10, n_tasks=10, pc_valid=0.1, savename='./logs/PMNIST/DFGP/', seed=2)
====================================================================================================
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  0 (pmnist-0)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.01
----------------------------------------
Model parameters ---
----------------------------------------
Epoch   1 | Train: loss=0.177, acc= 95.0% | time=7444.9ms |
 Valid: loss=0.169, acc= 95.4% |

Epoch   2 | Train: loss=0.119, acc= 96.7% | time=7423.5ms |
 Valid: loss=0.121, acc= 96.6% |

Epoch   3 | Train: loss=0.091, acc= 97.5% | time=7378.4ms |
 Valid: loss=0.101, acc= 96.9% |

Epoch   4 | Train: loss=0.074, acc= 97.9% | time=7467.3ms |
 Valid: loss=0.089, acc= 97.2% |

Epoch   5 | Train: loss=0.060, acc= 98.3% | time=7447.2ms |
 Valid: loss=0.082, acc= 97.5% |

----------------------------------------
Test: loss=0.081 , acc= 97.4%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 70/784
Layer 2 : 64/100
Layer 3 : 48/100
----------------------------------------
Accuracies =
 97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  1 (pmnist-1)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.136, acc= 96.2% | time=8005.8ms |
 Valid: loss=0.138, acc= 96.2% |

Epoch   2 | Train: loss=0.102, acc= 97.2% | time=8098.2ms |
 Valid: loss=0.111, acc= 96.9% |

Epoch   3 | Train: loss=0.085, acc= 97.7% | time=8052.3ms |
 Valid: loss=0.098, acc= 97.0% |

Epoch   4 | Train: loss=0.073, acc= 98.1% | time=8080.0ms |
 Valid: loss=0.089, acc= 97.4% |

Epoch   5 | Train: loss=0.064, acc= 98.3% | time=8091.5ms |
 Valid: loss=0.084, acc= 97.5% |

Test: loss=0.084 , acc= 97.5%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 137/784
Layer 2 : 87/100
Layer 3 : 68/100
----------------------------------------
Accuracies =
 97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.3%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  2 (pmnist-2)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.150, acc= 95.7% | time=8162.3ms |
 Valid: loss=0.154, acc= 95.8% |

Epoch   2 | Train: loss=0.111, acc= 96.9% | time=8072.8ms |
 Valid: loss=0.121, acc= 96.6% |

Epoch   3 | Train: loss=0.093, acc= 97.5% | time=8089.2ms |
 Valid: loss=0.108, acc= 96.8% |

Epoch   4 | Train: loss=0.078, acc= 97.9% | time=8105.6ms |
 Valid: loss=0.096, acc= 97.3% |

Epoch   5 | Train: loss=0.069, acc= 98.1% | time=8102.1ms |
 Valid: loss=0.091, acc= 97.5% |

Test: loss=0.089 , acc= 97.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 196/784
Layer 2 : 95/100
Layer 3 : 77/100
----------------------------------------
Accuracies =
 97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.3%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.0%  97.4%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  3 (pmnist-3)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.175, acc= 95.0% | time=8035.6ms |
 Valid: loss=0.173, acc= 95.1% |

Epoch   2 | Train: loss=0.126, acc= 96.4% | time=8068.2ms |
 Valid: loss=0.132, acc= 96.3% |

Epoch   3 | Train: loss=0.105, acc= 97.0% | time=8126.0ms |
 Valid: loss=0.116, acc= 96.7% |

Epoch   4 | Train: loss=0.092, acc= 97.5% | time=8165.1ms |
 Valid: loss=0.106, acc= 96.9% |

Epoch   5 | Train: loss=0.082, acc= 97.8% | time=8110.4ms |
 Valid: loss=0.098, acc= 97.1% |

Test: loss=0.097 , acc= 97.0%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 254/784
Layer 2 : 98/100
Layer 3 : 82/100
----------------------------------------
Accuracies =
 97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.3%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.0%  97.4%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.9%  97.2%  97.0%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  4 (pmnist-4)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.190, acc= 94.5% | time=8103.2ms |
 Valid: loss=0.187, acc= 94.7% |

Epoch   2 | Train: loss=0.144, acc= 96.0% | time=8036.2ms |
 Valid: loss=0.148, acc= 96.0% |

Epoch   3 | Train: loss=0.119, acc= 96.6% | time=8142.5ms |
 Valid: loss=0.128, acc= 96.5% |

Epoch   4 | Train: loss=0.106, acc= 97.1% | time=7986.8ms |
 Valid: loss=0.118, acc= 96.8% |

Epoch   5 | Train: loss=0.095, acc= 97.4% | time=8138.8ms |
 Valid: loss=0.111, acc= 96.9% |

Test: loss=0.111 , acc= 96.8%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 307/784
Layer 2 : 99/100
Layer 3 : 85/100
----------------------------------------
Accuracies =
 97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.3%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.0%  97.4%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.9%  97.2%  97.0%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.6%  97.0%  96.5%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  5 (pmnist-5)
****************************************************************************************************
----------------------------------------
Task ID :5 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.191, acc= 94.5% | time=8166.2ms |
 Valid: loss=0.194, acc= 94.5% |

Epoch   2 | Train: loss=0.145, acc= 96.0% | time=8069.0ms |
 Valid: loss=0.155, acc= 95.5% |

Epoch   3 | Train: loss=0.124, acc= 96.6% | time=8130.0ms |
 Valid: loss=0.137, acc= 96.3% |

Epoch   4 | Train: loss=0.108, acc= 97.1% | time=8106.7ms |
 Valid: loss=0.125, acc= 96.6% |

Epoch   5 | Train: loss=0.097, acc= 97.4% | time=8012.3ms |
 Valid: loss=0.117, acc= 96.8% |

Test: loss=0.113 , acc= 96.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 355/784
Layer 2 : 100/100
Layer 3 : 86/100
----------------------------------------
Accuracies =
 97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.3%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.0%  97.4%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.9%  97.2%  97.0%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.6%  97.0%  96.5%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.1%  96.8%  96.1%  96.6%  96.3%  96.7%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  6 (pmnist-6)
****************************************************************************************************
----------------------------------------
Task ID :6 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.231, acc= 93.4% | time=8175.9ms |
 Valid: loss=0.227, acc= 93.8% |

Epoch   2 | Train: loss=0.173, acc= 95.1% | time=8086.1ms |
 Valid: loss=0.176, acc= 95.0% |

Epoch   3 | Train: loss=0.148, acc= 95.9% | time=8120.2ms |
 Valid: loss=0.156, acc= 95.6% |

Epoch   4 | Train: loss=0.132, acc= 96.3% | time=8101.3ms |
 Valid: loss=0.144, acc= 96.0% |

Epoch   5 | Train: loss=0.118, acc= 96.7% | time=8083.9ms |
 Valid: loss=0.133, acc= 96.2% |

Test: loss=0.131 , acc= 96.1%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 396/784
Layer 2 : 100/100
Layer 3 : 87/100
----------------------------------------
Accuracies =
 97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.3%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.0%  97.4%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.9%  97.2%  97.0%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.6%  97.0%  96.5%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.1%  96.8%  96.1%  96.6%  96.3%  96.7%   0.0%   0.0%   0.0%   0.0% 
 95.6%  96.3%  95.6%  96.3%  96.1%  96.3%  96.1%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  7 (pmnist-7)
****************************************************************************************************
----------------------------------------
Task ID :7 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.237, acc= 93.0% | time=8053.1ms |
 Valid: loss=0.237, acc= 93.1% |

Epoch   2 | Train: loss=0.179, acc= 94.8% | time=8117.5ms |
 Valid: loss=0.186, acc= 94.6% |

Epoch   3 | Train: loss=0.152, acc= 95.7% | time=8033.3ms |
 Valid: loss=0.164, acc= 95.3% |

Epoch   4 | Train: loss=0.133, acc= 96.2% | time=8086.2ms |
 Valid: loss=0.148, acc= 95.6% |

Epoch   5 | Train: loss=0.121, acc= 96.6% | time=8028.2ms |
 Valid: loss=0.140, acc= 95.8% |

Test: loss=0.139 , acc= 95.8%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 436/784
Layer 2 : 100/100
Layer 3 : 88/100
----------------------------------------
Accuracies =
 97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.3%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.0%  97.4%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.9%  97.2%  97.0%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.6%  97.0%  96.5%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.1%  96.8%  96.1%  96.6%  96.3%  96.7%   0.0%   0.0%   0.0%   0.0% 
 95.6%  96.3%  95.6%  96.3%  96.1%  96.3%  96.1%   0.0%   0.0%   0.0% 
 95.2%  95.8%  95.5%  95.8%  95.7%  96.0%  95.5%  95.8%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  8 (pmnist-8)
****************************************************************************************************
----------------------------------------
Task ID :8 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.286, acc= 91.6% | time=8095.9ms |
 Valid: loss=0.278, acc= 91.8% |

Epoch   2 | Train: loss=0.215, acc= 93.8% | time=8101.4ms |
 Valid: loss=0.214, acc= 93.6% |

Epoch   3 | Train: loss=0.182, acc= 94.8% | time=8117.3ms |
 Valid: loss=0.185, acc= 94.7% |

Epoch   4 | Train: loss=0.161, acc= 95.5% | time=8063.3ms |
 Valid: loss=0.166, acc= 95.3% |

Epoch   5 | Train: loss=0.146, acc= 95.9% | time=8020.8ms |
 Valid: loss=0.154, acc= 95.7% |

Test: loss=0.151 , acc= 95.5%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 472/784
Layer 2 : 100/100
Layer 3 : 89/100
----------------------------------------
Accuracies =
 97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.3%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.0%  97.4%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.9%  97.2%  97.0%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.6%  97.0%  96.5%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.1%  96.8%  96.1%  96.6%  96.3%  96.7%   0.0%   0.0%   0.0%   0.0% 
 95.6%  96.3%  95.6%  96.3%  96.1%  96.3%  96.1%   0.0%   0.0%   0.0% 
 95.2%  95.8%  95.5%  95.8%  95.7%  96.0%  95.5%  95.8%   0.0%   0.0% 
 94.7%  95.8%  95.1%  95.4%  95.4%  95.2%  95.1%  95.3%  95.5%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  9 (pmnist-9)
****************************************************************************************************
----------------------------------------
Task ID :9 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.299, acc= 91.0% | time=8066.3ms |
 Valid: loss=0.295, acc= 91.1% |

Epoch   2 | Train: loss=0.228, acc= 93.2% | time=8134.1ms |
 Valid: loss=0.230, acc= 93.4% |

Epoch   3 | Train: loss=0.192, acc= 94.4% | time=8050.6ms |
 Valid: loss=0.198, acc= 94.3% |

Epoch   4 | Train: loss=0.170, acc= 95.1% | time=8155.4ms |
 Valid: loss=0.181, acc= 95.0% |

Epoch   5 | Train: loss=0.154, acc= 95.6% | time=8073.3ms |
 Valid: loss=0.167, acc= 95.4% |

Test: loss=0.168 , acc= 95.0%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
Skip Updating GPM for layer: 3
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 502/784
Layer 2 : 100/100
Layer 3 : 89/100
----------------------------------------
Accuracies =
 97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.3%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.0%  97.4%  97.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.9%  97.2%  97.0%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.6%  97.0%  96.5%  96.9%  96.8%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.1%  96.8%  96.1%  96.6%  96.3%  96.7%   0.0%   0.0%   0.0%   0.0% 
 95.6%  96.3%  95.6%  96.3%  96.1%  96.3%  96.1%   0.0%   0.0%   0.0% 
 95.2%  95.8%  95.5%  95.8%  95.7%  96.0%  95.5%  95.8%   0.0%   0.0% 
 94.7%  95.8%  95.1%  95.4%  95.4%  95.2%  95.1%  95.3%  95.5%   0.0% 
 93.7%  94.9%  94.6%  94.9%  94.8%  94.5%  94.5%  94.6%  95.0%  95.0% 
--------------------------------------------------
Task Order : [0 1 2 3 4 5 6 7 8 9]
Final Avg Accuracy: 94.65%
Backward transfer: -2.09%
[Elapsed time = 433858.7 ms]
--------------------------------------------------
====================================================================================================
Arguments =
Namespace(batch_size_test=64, batch_size_train=10, gpm_thro1=0.94, gpm_thro2=0.99, gpm_thro3=0.99, lr=0.01, lr_factor=2, lr_min=1e-05, lr_patience=6, mixup_alpha=20, mixup_weight=0.1, momentum=0.9, n_epochs=5, n_hidden=100, n_outputs=10, n_tasks=10, pc_valid=0.1, savename='./logs/PMNIST/DFGP/', seed=3)
====================================================================================================
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  0 (pmnist-0)
****************************************************************************************************
----------------------------------------
Task ID :0 | Learning Rate : 0.01
----------------------------------------
Model parameters ---
----------------------------------------
Epoch   1 | Train: loss=0.174, acc= 95.0% | time=7352.5ms |
 Valid: loss=0.169, acc= 95.3% |

Epoch   2 | Train: loss=0.114, acc= 96.8% | time=7383.1ms |
 Valid: loss=0.119, acc= 96.8% |

Epoch   3 | Train: loss=0.089, acc= 97.6% | time=7396.1ms |
 Valid: loss=0.100, acc= 97.3% |

Epoch   4 | Train: loss=0.070, acc= 98.1% | time=7461.2ms |
 Valid: loss=0.087, acc= 97.5% |

Epoch   5 | Train: loss=0.057, acc= 98.5% | time=7459.4ms |
 Valid: loss=0.079, acc= 97.8% |

----------------------------------------
Test: loss=0.076 , acc= 97.8%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 71/784
Layer 2 : 62/100
Layer 3 : 47/100
----------------------------------------
Accuracies =
 97.8%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  1 (pmnist-1)
****************************************************************************************************
----------------------------------------
Task ID :1 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.134, acc= 96.2% | time=8032.1ms |
 Valid: loss=0.139, acc= 95.9% |

Epoch   2 | Train: loss=0.104, acc= 97.1% | time=8104.8ms |
 Valid: loss=0.118, acc= 96.5% |

Epoch   3 | Train: loss=0.082, acc= 97.7% | time=8030.1ms |
 Valid: loss=0.102, acc= 97.2% |

Epoch   4 | Train: loss=0.071, acc= 98.1% | time=8131.9ms |
 Valid: loss=0.093, acc= 97.3% |

Epoch   5 | Train: loss=0.062, acc= 98.3% | time=8093.6ms |
 Valid: loss=0.086, acc= 97.5% |

Test: loss=0.084 , acc= 97.5%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 137/784
Layer 2 : 86/100
Layer 3 : 69/100
----------------------------------------
Accuracies =
 97.8%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.6%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  2 (pmnist-2)
****************************************************************************************************
----------------------------------------
Task ID :2 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.147, acc= 95.8% | time=8144.8ms |
 Valid: loss=0.149, acc= 95.8% |

Epoch   2 | Train: loss=0.108, acc= 97.0% | time=8079.7ms |
 Valid: loss=0.117, acc= 96.5% |

Epoch   3 | Train: loss=0.089, acc= 97.6% | time=8170.3ms |
 Valid: loss=0.102, acc= 97.0% |

Epoch   4 | Train: loss=0.077, acc= 98.0% | time=8191.6ms |
 Valid: loss=0.096, acc= 97.3% |

Epoch   5 | Train: loss=0.069, acc= 98.2% | time=8030.8ms |
 Valid: loss=0.089, acc= 97.5% |

Test: loss=0.088 , acc= 97.4%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 199/784
Layer 2 : 95/100
Layer 3 : 78/100
----------------------------------------
Accuracies =
 97.8%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.6%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.4%  97.2%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  3 (pmnist-3)
****************************************************************************************************
----------------------------------------
Task ID :3 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.157, acc= 95.5% | time=8109.8ms |
 Valid: loss=0.157, acc= 95.6% |

Epoch   2 | Train: loss=0.118, acc= 96.7% | time=8127.6ms |
 Valid: loss=0.126, acc= 96.5% |

Epoch   3 | Train: loss=0.097, acc= 97.3% | time=8086.0ms |
 Valid: loss=0.110, acc= 97.0% |

Epoch   4 | Train: loss=0.085, acc= 97.6% | time=8097.5ms |
 Valid: loss=0.103, acc= 97.0% |

Epoch   5 | Train: loss=0.077, acc= 97.9% | time=8097.0ms |
 Valid: loss=0.097, acc= 97.2% |

Test: loss=0.097 , acc= 97.0%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 253/784
Layer 2 : 98/100
Layer 3 : 82/100
----------------------------------------
Accuracies =
 97.8%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.6%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.4%  97.2%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.1%  97.1%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  4 (pmnist-4)
****************************************************************************************************
----------------------------------------
Task ID :4 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.178, acc= 94.8% | time=8112.3ms |
 Valid: loss=0.175, acc= 95.2% |

Epoch   2 | Train: loss=0.134, acc= 96.2% | time=8034.3ms |
 Valid: loss=0.138, acc= 96.3% |

Epoch   3 | Train: loss=0.112, acc= 96.9% | time=8153.4ms |
 Valid: loss=0.121, acc= 96.8% |

Epoch   4 | Train: loss=0.096, acc= 97.3% | time=8086.9ms |
 Valid: loss=0.110, acc= 96.9% |

Epoch   5 | Train: loss=0.087, acc= 97.6% | time=8152.2ms |
 Valid: loss=0.104, acc= 97.0% |

Test: loss=0.106 , acc= 96.9%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 304/784
Layer 2 : 99/100
Layer 3 : 85/100
----------------------------------------
Accuracies =
 97.8%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.6%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.4%  97.2%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.1%  97.1%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.8%  96.8%  96.6%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  5 (pmnist-5)
****************************************************************************************************
----------------------------------------
Task ID :5 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.206, acc= 94.0% | time=8155.4ms |
 Valid: loss=0.194, acc= 94.3% |

Epoch   2 | Train: loss=0.153, acc= 95.7% | time=8132.5ms |
 Valid: loss=0.150, acc= 95.9% |

Epoch   3 | Train: loss=0.127, acc= 96.4% | time=8206.7ms |
 Valid: loss=0.131, acc= 96.4% |

Epoch   4 | Train: loss=0.112, acc= 96.8% | time=8117.4ms |
 Valid: loss=0.121, acc= 96.6% |

Epoch   5 | Train: loss=0.101, acc= 97.2% | time=8104.4ms |
 Valid: loss=0.114, acc= 96.8% |

Test: loss=0.114 , acc= 96.5%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 351/784
Layer 2 : 99/100
Layer 3 : 87/100
----------------------------------------
Accuracies =
 97.8%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.6%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.4%  97.2%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.1%  97.1%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.8%  96.8%  96.6%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.4%  96.3%  96.4%  96.5%  96.5%  96.5%   0.0%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  6 (pmnist-6)
****************************************************************************************************
----------------------------------------
Task ID :6 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.227, acc= 93.3% | time=8095.2ms |
 Valid: loss=0.220, acc= 93.7% |

Epoch   2 | Train: loss=0.170, acc= 95.1% | time=8123.2ms |
 Valid: loss=0.172, acc= 95.2% |

Epoch   3 | Train: loss=0.143, acc= 96.0% | time=8131.9ms |
 Valid: loss=0.151, acc= 95.7% |

Epoch   4 | Train: loss=0.125, acc= 96.4% | time=8156.3ms |
 Valid: loss=0.136, acc= 96.1% |

Epoch   5 | Train: loss=0.112, acc= 96.8% | time=8132.9ms |
 Valid: loss=0.126, acc= 96.3% |

Test: loss=0.125 , acc= 96.3%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 394/784
Layer 2 : 99/100
Layer 3 : 88/100
----------------------------------------
Accuracies =
 97.8%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.6%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.4%  97.2%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.1%  97.1%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.8%  96.8%  96.6%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.4%  96.3%  96.4%  96.5%  96.5%  96.5%   0.0%   0.0%   0.0%   0.0% 
 96.0%  96.1%  96.2%  96.0%  96.1%  95.9%  96.3%   0.0%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  7 (pmnist-7)
****************************************************************************************************
----------------------------------------
Task ID :7 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.261, acc= 92.5% | time=8011.0ms |
 Valid: loss=0.252, acc= 92.4% |

Epoch   2 | Train: loss=0.197, acc= 94.5% | time=8122.8ms |
 Valid: loss=0.195, acc= 94.2% |

Epoch   3 | Train: loss=0.166, acc= 95.3% | time=8140.8ms |
 Valid: loss=0.169, acc= 95.0% |

Epoch   4 | Train: loss=0.148, acc= 95.9% | time=8155.5ms |
 Valid: loss=0.155, acc= 95.5% |

Epoch   5 | Train: loss=0.132, acc= 96.3% | time=8034.2ms |
 Valid: loss=0.142, acc= 95.9% |

Test: loss=0.143 , acc= 95.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 433/784
Layer 2 : 100/100
Layer 3 : 90/100
----------------------------------------
Accuracies =
 97.8%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.6%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.4%  97.2%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.1%  97.1%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.8%  96.8%  96.6%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.4%  96.3%  96.4%  96.5%  96.5%  96.5%   0.0%   0.0%   0.0%   0.0% 
 96.0%  96.1%  96.2%  96.0%  96.1%  95.9%  96.3%   0.0%   0.0%   0.0% 
 95.5%  95.9%  96.0%  95.3%  95.7%  95.3%  95.7%  95.7%   0.0%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  8 (pmnist-8)
****************************************************************************************************
----------------------------------------
Task ID :8 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.272, acc= 91.9% | time=8201.8ms |
 Valid: loss=0.264, acc= 91.9% |

Epoch   2 | Train: loss=0.204, acc= 94.1% | time=8141.0ms |
 Valid: loss=0.206, acc= 94.2% |

Epoch   3 | Train: loss=0.172, acc= 95.0% | time=8100.0ms |
 Valid: loss=0.180, acc= 94.9% |

Epoch   4 | Train: loss=0.154, acc= 95.7% | time=8034.0ms |
 Valid: loss=0.165, acc= 95.3% |

Epoch   5 | Train: loss=0.139, acc= 96.0% | time=8182.4ms |
 Valid: loss=0.154, acc= 95.7% |

Test: loss=0.148 , acc= 95.6%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 467/784
Layer 2 : 100/100
Layer 3 : 91/100
----------------------------------------
Accuracies =
 97.8%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.6%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.4%  97.2%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.1%  97.1%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.8%  96.8%  96.6%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.4%  96.3%  96.4%  96.5%  96.5%  96.5%   0.0%   0.0%   0.0%   0.0% 
 96.0%  96.1%  96.2%  96.0%  96.1%  95.9%  96.3%   0.0%   0.0%   0.0% 
 95.5%  95.9%  96.0%  95.3%  95.7%  95.3%  95.7%  95.7%   0.0%   0.0% 
 94.9%  95.3%  95.3%  94.7%  95.0%  95.0%  95.5%  95.2%  95.6%   0.0% 
threshold:[0.94 0.99 0.99]
****************************************************************************************************
Task  9 (pmnist-9)
****************************************************************************************************
----------------------------------------
Task ID :9 | Learning Rate : 0.01
----------------------------------------
Layer 1 - Projection Matrix shape: torch.Size([784, 784])
Layer 2 - Projection Matrix shape: torch.Size([100, 100])
Layer 3 - Projection Matrix shape: torch.Size([100, 100])
----------------------------------------
Epoch   1 | Train: loss=0.313, acc= 90.7% | time=8163.5ms |
 Valid: loss=0.302, acc= 91.1% |

Epoch   2 | Train: loss=0.235, acc= 93.0% | time=8082.8ms |
 Valid: loss=0.234, acc= 93.1% |

Epoch   3 | Train: loss=0.198, acc= 94.2% | time=8110.9ms |
 Valid: loss=0.203, acc= 94.2% |

Epoch   4 | Train: loss=0.176, acc= 94.8% | time=8092.8ms |
 Valid: loss=0.184, acc= 94.8% |

Epoch   5 | Train: loss=0.160, acc= 95.4% | time=8037.2ms |
 Valid: loss=0.172, acc= 94.9% |

Test: loss=0.177 , acc= 94.7%
------------------------------
Representation Matrix
------------------------------
Layer 1 : (784, 300)
Layer 2 : (100, 300)
Layer 3 : (100, 300)
------------------------------
Skip Updating GPM for layer: 2
----------------------------------------
Gradient Constraints Summary
----------------------------------------
Layer 1 : 498/784
Layer 2 : 100/100
Layer 3 : 92/100
----------------------------------------
Accuracies =
 97.8%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.6%  97.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.4%  97.2%  97.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 97.2%  97.1%  97.1%  97.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.8%  96.8%  96.8%  96.6%  96.9%   0.0%   0.0%   0.0%   0.0%   0.0% 
 96.4%  96.3%  96.4%  96.5%  96.5%  96.5%   0.0%   0.0%   0.0%   0.0% 
 96.0%  96.1%  96.2%  96.0%  96.1%  95.9%  96.3%   0.0%   0.0%   0.0% 
 95.5%  95.9%  96.0%  95.3%  95.7%  95.3%  95.7%  95.7%   0.0%   0.0% 
 94.9%  95.3%  95.3%  94.7%  95.0%  95.0%  95.5%  95.2%  95.6%   0.0% 
 94.2%  94.5%  94.9%  94.1%  94.4%  94.5%  94.6%  94.5%  94.9%  94.7% 
--------------------------------------------------
Task Order : [0 1 2 3 4 5 6 7 8 9]
Final Avg Accuracy: 94.53%
Backward transfer: -2.23%
[Elapsed time = 434637.1 ms]
--------------------------------------------------